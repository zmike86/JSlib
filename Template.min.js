define(function(a,b,c){"use strict";var d=a("./lang/Object");var e=a("./UA");c.exports=function(){function t(a){n=-1;o=[];h=a.replace(/{\%([\s\S]*?)\%}/g,function(a,b){o[++n]='");_TemplateString'+c+"("+b+");_TemplateString"+c+'("';return"_flag"+n}).replace(/{\$([\s\S]*?)\$}/g,function(a,b){return"_TemplateString"+c+'("'+b.replace(/("|\\|\r|\n)/g,"\\$1")+'");'}).replace(/_flag(\d+)/g,function(a,b){return o[b]});i=h.replace(/"([^\\"]|\\[\s\S])*"|'([^\\']|\\[\s\S])*'/g,"").replace(/\.[\_\$\w]+/g,"").match(/[\_\$a-zA-Z]+[0-9]*/g);j=i.length;k="";while(j--){l=i[j];if(!m[l]){k+=l+'=_args["'+l+'"],';m[l]=true}}return"var "+k+"_TemplateString="+g+";"+h+" return _TemplateString"+f+";"}var a={};var b,c,f,g,h,i,j,k,l,m={},n,o,p,q,r=["break","case","catch","continue","debugger","default","delete","do","else","false","finally","for","function","if","in","instanceof","new","null","return","switch","this","throw","true","try","typeof","var","void","while","with","abstract","boolean","byte","char","class","const","double","enum","export","extends","final","float","goto","implements","import","int","interface","long","native","package","private","protected","public","short","static","super","synchronized","throws","transient","volatile","arguments","let","yield"];for(var s=0;s<r.length;s++){p=r[s];m[p]=true}b=!!e.browser.ie?e.browser.ie>=8:true;if(b){c="+=";g="''";f=""}else{c=".push";g="[]";f=".join('')"}return{helper:a,compile:function(a){var b=t(a);return{render:new Function("_args",b)}},extend:function(a,b){d.extend(a,b,true)}}}()})